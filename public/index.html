<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Horizon's Gate Mod Validator</title>
    <link rel="stylesheet" href="shared-base.css" />
    <link rel="stylesheet" href="validator.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <h1>Horizon's Gate Mod Validator</h1>
        <div class="header-actions">
          <a href="tasks.html" class="nav-link">Task Reference</a>
          <a href="formulas.html" class="nav-link">Formula Reference</a>
          <button id="themeToggle" class="theme-toggle" aria-label="Toggle theme">
            ðŸŒ™
          </button>
        </div>
      </header>

      <details class="known-issues">
        <summary>Known Issues</summary>
        <ul>
          <li><strong>Formula validation limitations:</strong> Formula parser doesn't handle @ expressions (@F, @G, etc.) yet.</li>
          <li><strong>Task validation incomplete:</strong> Task required arguments and task enum values are not yet validated.</li>
          <li><strong>Dialog text formatting:</strong> Text formatting tags (e.g., <code>&lt;foo=bar&gt;</code>) in dialog strings are not yet supported.</li>
        </ul>
      </details>

      <main id="main">
        <!-- File tree (hidden by default) -->
        <div id="fileTree" class="file-tree-section" style="display: none;">
          <div class="section-header">
            <h2>Files</h2>
          </div>
          <div id="fileTreeContent" class="file-tree-content"></div>
        </div>

        <div class="editor-section">
          <div class="section-header">
            <h2>Mod Code</h2>
            <div class="actions">
              <button id="clearBtn" class="btn btn-secondary">Clear</button>
              <div class="upload-dropdown">
                <button id="uploadBtn" class="btn btn-secondary">
                  Open â–¾
                </button>
                <div class="upload-menu">
                  <button id="uploadFilesBtn" class="upload-menu-item">Open Files</button>
                  <button id="uploadDirBtn" class="upload-menu-item">Open Directory</button>
                </div>
                <input type="file" id="fileInput" style="display: none;" multiple />
                <input type="file" id="dirInput" style="display: none;" webkitdirectory directory />
              </div>
              <button id="loadSampleBtn" class="btn btn-secondary">
                Load Sample
              </button>
              <button id="downloadZipBtn" class="btn btn-secondary" style="display: none;">
                Export ZIP
              </button>
              <button id="validateBtn" class="btn btn-primary">Validate</button>
            </div>
          </div>
          <div class="editor-wrapper">
            <div class="line-numbers" id="lineNumbers"></div>
            <textarea
              id="modInput"
              placeholder="Paste your mod code here...

Example:
[Action] ID=greatswordAttack;
	applyWeaponBuffs=true;

	casterAnimation=broadswing;
	casterAnimationDependsOnWeaponHand=true;
	FXChangesWithWeaponHand=true;
	FXOnTarget=swipe;
[ActionAoE]
	ID=greatswordAttack;
	cloneFrom=adjacent;
[AvAffecter]
	ID=greatswordAttack;
	actorValue=HP;
	magnitude= d:gswordDmg;
	duration=-2;
	chance=d:gswordAcc;
	element=melee;
	element=physical;
	element=slash;
	element=heavySlash;
[AvAffecterAoE]
	ID=greatswordAttack;
	aoeCasterAsOrigin=true;
	maxRange = 1.5;
	coneAngle=90;
"
              spellcheck="false"
            ></textarea>
          </div>
        </div>

        <div class="results-section">
          <div class="section-header">
            <h2>Validation Results</h2>
            <div id="validationStatus" class="status"></div>
          </div>
          <div id="results" class="results-container">
            <p class="placeholder">
              No validation results yet. Paste your mod code and click
              "Validate".
            </p>
          </div>
        </div>
      </main>
    </div>

    <script src="validator.bundle.js"></script>
    <script src="app.bundle.js"></script>
  </body>
</html>
